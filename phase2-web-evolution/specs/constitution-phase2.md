# Phase 2 Constitution: Full-Stack Web Application
**Project:** Evolution of Todo – Hackathon II

## Project Vision
Transform the Phase 1 in-memory console Todo app into a secure, multi-user, persistent Full-Stack web application while strictly adhering to Spec-Driven Development principles. The engineer must act as a System Architect – no manual code writing is allowed. All implementation must be generated by Claude Code after refining and approving detailed specifications.

## Core Principles (Non-Negotiable)
1. Zero Manual Coding – Har feature ke liye pehle detailed Markdown spec likho aur approve karo. Sirf tab Claude Code se implementation generate karwao. Spec refine karte raho jab tak output 100% correct na ho jaye.
2. Reusability & Clean Architecture – Phase 1 ke core logic ko reuse karo lekin multi-user aur persistent storage ke liye adapt karo.
3. Security First – Har user sirf apne tasks dekh aur modify kar sake. No data leakage between users.
4. Professional Standards – Code must follow best practices, type safety, error handling, documentation aur testing conventions.

## Technology Stack (Mandatory)
- Frontend: Next.js 16+ (App Router), TypeScript, Tailwind CSS
- Backend: FastAPI (Python), SQLModel ORM
- Database: Neon Serverless PostgreSQL
- Authentication: Better Auth (with JWT plugin enabled)
- Development Tools: UV, Claude Code, Spec-Kit Plus
- Project Structure: Monorepo with organized /specs folder as per Spec-Kit Plus guidelines

## Authentication & Security Rules
- Better Auth JWT tokens must be used for all API requests
- Shared secret (BETTER_AUTH_SECRET) same on both frontend and backend
- All API endpoints require valid JWT in Authorization: Bearer <token> header
- Backend middleware must verify JWT and extract user_id
- All database queries MUST filter by authenticated user_id
- Unauthorized requests → 401 Unauthorized
- User isolation strictly enforced – no user can access another's tasks

## Required API Endpoints (Exact Paths)
- GET /api/tasks → List tasks for authenticated user
- POST /api/tasks → Create new task
- GET /api/tasks/{id} → Get single task
- PUT /api/tasks/{id} → Update task
- DELETE /api/tasks/{id} → Delete task
- PATCH /api/tasks/{id}/complete → Toggle completion

Note: User ownership enforced via JWT, no user_id in URL required after auth.

## Database Schema Requirements
- tasks table with columns:
  - id (Primary Key)
  - user_id (Foreign Key to Better Auth users)
  - title (string, required)
  - description (text, optional)
  - completed (boolean, default false)
  - created_at, updated_at (timestamps)
- Proper indexes on user_id and completed

## Spec-Kit Plus Structure (Must Follow)
- /.spec-kit/config.yaml with proper phases and directories
- /specs/overview.md, architecture.md
- /specs/features/task-crud.md, authentication.md
- /specs/api/rest-endpoints.md
- /specs/database/schema.md
- /specs/ui/components.md, pages.md
- Multiple CLAUDE.md files (root, /frontend, /backend)

## Development Workflow (Strict)
1. Update or create detailed spec in /specs/
2. Reference spec using @specs/path/to/file.md in prompts
3. Ask Claude Code to implement specific feature/endpoints/models/UI
4. Review generated code → if incorrect, refine spec and repeat
5. Log major prompt iterations in /specs/history/phase2-log.md

## Deliverables Checklist
- Public GitHub monorepo with proper structure
- Working full-stack app (Vercel + backend deployed)
- Multi-user support with proper authentication
- All basic CRUD operations functional per user
- Demo video under 90 seconds
- README.md with setup and running instructions
- CLAUDE.md files with clear guidelines

## Bonus Alignment
This constitution supports future phases:
- Phase 3: Easy integration of AI chatbot via MCP tools
- Phase 4–5: Containerization and Kubernetes deployment

Violation of any core principle will result in spec rejection and re-iteration.

Approved by: [Apna Naam Yahan Daalo] – Phase 2 System Architect
Date: January 07, 2026